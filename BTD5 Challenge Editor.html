<!DOCTYPE html>
<html style="margin: 0px;height: 100%;width: 100%;">
	<head>  <meta charset="UTF-8"> <link href="https://fonts.googleapis.com/css?family=Luckiest+Guy" rel="stylesheet">

		<style>
@font-face { font-family: btd5; src: url('./Font/oetztype.ttf'); } 
.modal {
	display: none;
	z-index: 1;
	padding-top: 100px;
	padding: 0;

	position: absolute;
	top: 50%;
	left:50%;
	margin-left: -180px;
	margin-top: -450px;
	background-color: rgb(0,0,0);
	background-color: rgba(0,0,0,0);
}
.modal-content {
	background-image: url("");
	background-color: #fefefe;
	margin: auto;
	z-index: 1;
	padding-top: 0px;
	padding: 1px;
	border: 1px solid #888;
	width: 800px;
	height: 450px;

}
.close {
	position:absolute;
	right: 14px;
	padding: 0px;
	color: #aaaaaa;
	float: right;
	width: 40px;
	height: 40px;
	font-weight: bold;
}
.close:hover,
.close:focus {
	color: #000;
	text-decoration: none;
	cursor: pointer;
}
	.modal2 {
		display: none;
		z-index: 1;
		padding-top: 100px;
		padding: 0;

		position: absolute;
		top: 50%;
		left:50%;
		margin-left: -200px;
		margin-top: 500px;
		background-color: rgb(0,0,0);
		background-color: rgba(0,0,0,0);
	}
	.modal-content2 {
		background-image: url("");
		background-color: #fefefe;
		margin: auto;
		z-index: 1;
		padding-top: 0px;
		padding: 1px;
		border: 1px solid #888;
		width: 500px;
		height: 450px;

	}
	.close2 {
		position:absolute;
		right: 14px;
		padding: 0px;
		color: #aaaaaa;
		float: right;
		width: 40px;
		height: 40px;
		font-weight: bold;
	}
	.close2:hover,
	.close2:focus {
		color: #000;
		text-decoration: none;
		cursor: pointer;
	}
	.container {
		position: relative;
		text-align: center;
		color: white;
		display:inline-block
	}
	.centered {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		text-shadow:
			-1px -1px 0 #000,
			1px -1px 0 #000,
			-1px 1px 0 #000,
			1px 1px 0 #000;
		font-size: 24px;
	}
	.slider {
		-webkit-appearance: none;
		width: 350px;
		height: 15px;
		border-radius: 5px;
		background: #38200F;
		outline: none;
		-webkit-transition: .2s;
		transition: opacity .2s;
	}
	.slider::-moz-range-thumb {
		width: 23px;
		height: 24px;
		border: 0;
		background: url('./Images/UI/sliderbtn.png');
		cursor: pointer;
	}
	p {
		font-family: btd5;
		color: white;
		text-shadow:
			-1px -1px 0 #000,
			1px -1px 0 #000,
			-1px 1px 0 #000,
			1px 1px 0 #000;
	}
	input {
		text-align-last:center;
		background-color: #436FA8;
		font-family: btd5;
		color: white;
		text-shadow:
			-1px -1px 0 #000,
			1px -1px 0 #000,
			-1px 1px 0 #000,
			1px 1px 0 #000;
	}
	select {
		text-align-last:center;
		background-color: #436FA8;
		font-family: btd5;
		color: white;
		text-shadow:
			-1px -1px 0 #000,
			1px -1px 0 #000,
			-1px 1px 0 #000,
			1px 1px 0 #000;
	}
	option {

	}
	button {
		text-align-last:center;
		background-color: #66AAFF;
		font-family: btd5;
		color: white;
		text-shadow:
			-1px -1px 0 #000,
			1px -1px 0 #000,
			-1px 1px 0 #000,
			1px 1px 0 #000;
		font-size: 18px;
	}
	.towerIcon {
		width:62px;
		height:71px;

	}
	.mapIcon {
		width:250px;
		height:180px;
	}
	.bloonIcon {
		width: 47px;
		height: 63px;
	}
	.specialtyIcon {
		width:135px;
		height:93px;

	}
		</style>
	</head>
	<body bgcolor="#5A8FD5"  style="width:750px; height:100px;">
		<img src="./Images/UI/benbtn.png" style="position: absolute;top: 0;padding: 7px;right: 0%;border:0;margin-left: auto;margin-right: auto;" onclick="advancedmode()">
		<div id="modal" class="modal">	<div style="max-width: 800px;top: -1000px;display: block;margin-left: auto;margin-right: auto;" id="class">	<div style="max-width: 800px; overflow:scroll;background-color: #436FA8;" id="bg" class="modal-content">	
					<span class="close" style="width: 25px; height: 25px;"><img src="./Images/UI/exitbtn.png" style="width: 25px; height: 25px;"></img></span>
					<div class="maps">
					</div>
				</div></div></div>
				</div></div>
				<div id="modal2" class="modal2">	<div style="max-width: 500px;top: -1000px;display: block;margin-left: auto;margin-right: auto;" id="class">	<div style="max-width: 500px; overflow:scroll;background-color: #436FA8;" id="bg" class="modal-content2">  
							<span class="close2" style="width: 25px; height: 25px;"><img src="./Images/UI/exitbtn.png" style="width: 25px; height: 25px;"></img></span>
							<div><img id ="red" src="./Images/Bloon/Red.png" class="bloonIcon"></img><input type="range" min="0" max="14" value="0" class="slider" id="RedSlider" oninput="changebloon(this.value,0)"><img id ="Red2" src="./Images/Bloon/Red.png" class="bloonIcon"></div>
							<div><img id ="blue" src="./Images/Bloon/Blue.png" class="bloonIcon"></img><input type="range" min="-1" max="13" value="0" class="slider" id="BlueSlider" oninput="changebloon(this.value,1)"><img id ="Blue2" src="./Images/Bloon/Blue.png" class="bloonIcon"></div>
							<div><img id ="green" src="./Images/Bloon/Green.png" class="bloonIcon"></img><input type="range" min="-2" max="12" value="0" class="slider" id="GreenSlider" oninput="changebloon(this.value,2)"><img id ="Green2" src="./Images/Bloon/Green.png" class="bloonIcon"></div>
							<div><img id ="yellow" src="./Images/Bloon/Yellow.png" class="bloonIcon"></img><input type="range" min="-3" max="11" value="0" class="slider" id="YellowSlider" oninput="changebloon(this.value,3)"><img id ="Yellow2" src="./Images/Bloon/Yellow.png" class="bloonIcon"></div>
							<div><img id ="pink" src="./Images/Bloon/Pink.png" class="bloonIcon"></img><input type="range" min="-4" max="10" value="0" class="slider" id="PinkSlider" oninput="changebloon(this.value,4)"><img id ="Pink2" src="./Images/Bloon/Pink.png" class="bloonIcon"></div>
							<div><img id ="black" src="./Images/Bloon/Black.png" class="bloonIcon"></img><input type="range" min="-5" max="9" value="0" class="slider" id="BlackSlider" oninput="changebloon(this.value,5)"><img id ="Black2" src="./Images/Bloon/Black.png" class="bloonIcon"></div>
							<div><img id ="white" src="./Images/Bloon/White.png" class="bloonIcon"></img><input type="range" min="-6" max="8" value="0" class="slider" id="WhiteSlider" oninput="changebloon(this.value,6)"><img id ="White2" src="./Images/Bloon/White.png" class="bloonIcon"></div>
							<div><img id ="lead" src="./Images/Bloon/Lead.png" class="bloonIcon"></img><input type="range" min="-7" max="7" value="0" class="slider" id="LeadSlider" oninput="changebloon(this.value,7)"><img id ="Lead2" src="./Images/Bloon/Lead.png" class="bloonIcon"></div>
							<div><img id ="zebra" src="./Images/Bloon/Zebra.png" class="bloonIcon"></img><input type="range" min="-8" max="6" value="0" class="slider" id="ZebraSlider" oninput="changebloon(this.value,8)"><img id ="Zebra2" src="./Images/Bloon/Zebra.png" class="bloonIcon"></div>;
							<div><img id ="rainbow" src="./Images/Bloon/Rainbow.png" class="bloonIcon"></img><input type="range" min="-9" max="5" value="0" class="slider" id="RainbowSlider" oninput="changebloon(this.value,9)"><img id ="Rainbow2" src="./Images/Bloon/Rainbow.png" class="bloonIcon"></div>
							<div><img id ="ceramic" src="./Images/Bloon/Ceramic.png" class="bloonIcon"></img><input type="range" min="-10" max="4" value="0" class="slider" id="CeramicSlider" oninput="changebloon(this.value,10)"><img id ="Ceramic2" src="./Images/Bloon/Ceramic.png" class="bloonIcon"></div>
							<div><img id ="moab" src="./Images/Bloon/MOAB.png" class="bloonIcon"></img><input type="range" min="-12" max="2" value="0" class="slider" id="MOABSlider" oninput="changebloon(this.value,12)"><img id ="MOAB2" src="./Images/Bloon/MOAB.png" class="bloonIcon"></div>
							<div><img id ="bfb" src="./Images/Bloon/BFB.png" class="bloonIcon"></img><input type="range" min="-13" max="1" value="0" class="slider" id="BFBSlider" oninput="changebloon(this.value,13)"><img id ="BFB2" src="./Images/Bloon/BFB.png" class="bloonIcon"></div>
							<div><img id ="zomg" src="./Images/Bloon/ZOMG.png" class="bloonIcon"></img><input type="range" min="-14" max="0" value="0" class="slider" id="ZOMGSlider" oninput="changebloon(this.value,14)"><img id ="ZOMG2" src="./Images/Bloon/ZOMG.png" class="bloonIcon"></div>

						</div> </div> </div>
						<div>
							<p>&nbsp;Challenge Name:
							<input type="text" id="name" style="background-color: #436FA8;width: 300px;" value="Name">
							</p>
							<p>&nbsp;Challenge Description:
							<input type="text" id="description" style="background-color: #436FA8;width: 300px;" value="Description">
							</p>
							<p>&nbsp;Rank Required:
							<input type="text" id="rank" style="background-color: #436FA8;width: 30px;" value="20">
							</p>
							<p>&nbsp;Can Save: <input type="checkbox" id="CanSave" onclick=""></p>
							<div style="display: inline-block">
								<img id="changemapgear" src="./Images/Tracks/track_gear.png" style="position: absolute;width: 270px; height: 200px;" onclick="selectmap()"> <!-- onclick="selectmap() -->
								<img id="changemapbtn" src="./Images/Tracks/monkey_lane_thumb.jpg" style="width: 250px; height: 180px;" onclick="selectmap()">
							</div>
							<div style="display: inline-block">
								<p>&nbsp;Game Mode:
								<select id="gamemode" name="type" onchange="changegamemode(value)">
									<option value="0">Easy</option>
									<option value="1">Medium</option>
									<option value="2">Hard</option>
									<option value="3">Not Impoppable?</option>
									<option value="4">Deflation</option>
									<option value="5">Apocalypse</option>
								</select>
								</p>
								<p>&nbsp;Starting Cash:
								<input type="text" id="startcash" style="width: 75px" value="DEFAULT">
								</p>
								<p>&nbsp;Starting Lives:
								<input type="text" id="startlives" style="width: 75px" value="DEFAULT">
								</p>
								<p>&nbsp;Start Round:
								<input type="text" id="startround" style="width: 75px" value="1">
								</p>
								<p>&nbsp;End Round:
								<input type="text" id="endround" style="width: 75px" value="DEFAULT">
								</p>
							</div>
						</div>
						<p>&nbsp;Lock Towers: </p>
						<div id = "towers">
						</div>
						<p>&nbsp;Max Monkeys:
						<input type="text" id="maxmonkeys" style="width: 30px" value="-1">
						</p>
						<p>&nbsp;Max of Each Monkey:
						<input type="text" id="maxeachmonkeys" style="width: 30px" value="-1">
						</p>
						<div>
							<p>&nbsp;Lock Upgrades: </p>
							<div id ="locks"></div>
						</div>
						<p>&nbsp;Disable Lab Upgrades: </p>
						<div id = "labUpgrades"></div>
						<p>&nbsp;Disable Speciality Buildings: </p>
						<img id ="AcePrivateHangar" src="./Images/Buildings/AcePrivateHangar.png" class="specialtyIcon" onclick="buildingblock(0)"></img>
						<img id ="AlsCustomChippers" src="./Images/Buildings/AlsCustomChippers.png" class="specialtyIcon" onclick="buildingblock(1)"></img>
						<img id ="BombingRange" src="./Images/Buildings/BombingRange.png" class="specialtyIcon" onclick="buildingblock(2)"></img>
						<img id ="BoomerangDojo" src="./Images/Buildings/BoomerangDojo.png" class="specialtyIcon" onclick="buildingblock(3)"></img>
						<img id ="DartlingAmmoDump" src="./Images/Buildings/DartlingAmmoDump.png" class="specialtyIcon" onclick="buildingblock(4)"></img>
						<img id ="DartTrainingFacility" src="./Images/Buildings/DartTrainingFacility.png" class="specialtyIcon" onclick="buildingblock(5)"></img>
						<img id ="EngineersWorkshop" src="./Images/Buildings/EngineersWorkshop.png" class="specialtyIcon" onclick="buildingblock(6)"></img>
						<img id ="GlueSupplyDepot" src="./Images/Buildings/GlueSupplyDepot.png" class="specialtyIcon" onclick="buildingblock(7)"></img>
						<img id ="HeloHangar" src="./Images/Buildings/HeloHangar.png" class="specialtyIcon" onclick="buildingblock(8)"></img>
						<img id ="IceFortress" src="./Images/Buildings/IceFortress.png" class="specialtyIcon" onclick="buildingblock(9)"></img>
						<img id ="MageSpire" src="./Images/Buildings/MageSpire.png" class="specialtyIcon" onclick="buildingblock(10)"></img>
						<img id ="MortarEmplacement" src="./Images/Buildings/MortarEmplacement.png" class="specialtyIcon" onclick="buildingblock(11)"></img>
						<img id ="NinjaAcademy" src="./Images/Buildings/NinjaAcademy.png" class="specialtyIcon" onclick="buildingblock(12)"></img>
						<img id ="PirateCove" src="./Images/Buildings/PirateCove.png" class="specialtyIcon" onclick="buildingblock(13)"></img>
						<img id ="RifleRange" src="./Images/Buildings/RifleRange.png" class="specialtyIcon" onclick="buildingblock(14)"></img>
						<img id ="SpikesRUs" src="./Images/Buildings/SpikesRUs.png" class="specialtyIcon" onclick="buildingblock(15)"></img>
						<img id ="SubConstructionYard" src="./Images/Buildings/SubConstructionYard.png" class="specialtyIcon" onclick="buildingblock(16)"></img>
						<img id ="SuperMonkeyLair" src="./Images/Buildings/SuperMonkeyLair.png" class="specialtyIcon" onclick="buildingblock(17)"></img>
						<img id ="TackResearchCenter" src="./Images/Buildings/TackResearchCenter.png" class="specialtyIcon" onclick="buildingblock(18)"></img>
						<p> </p>
						<button onclick="bloonranks()">Change Bloon Ranks</button>
						<p> </p>
						<button onclick="finished()">Finished</button>
						<textarea id="output" rows="25" cols="75"></textarea> 
						<script>
//Defaut Declarations
var nk_title = "";
var nk_track = "monkey_lane";
var nk_rank_required = 30;
var nk_is_new = false;
var nk_id = 2019;
var nk_mode = 1;
var nk_description = "";
var LockedTowers = [];
var LockedUpgrades = [];

//Game Properties
var TargetRound = 0;
var CanSave = false;
var CanEarnMoney = true;
var MoneyPerRound = 100;
var CashPerPopModifier = 1.0;
var MaxNumberOfEachTower = -1;
var MaxNumberOfTotalTowers = -1;
var BlockedLabUpgrades = [];
var BlockedSpecialties = [];
var BloonLevelOffsets = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

//Setup
var Setup = [];
var Towers = [];
var StartingCash = 650;
var StartingLives = 100;
var StartRound = 1;
var Inventory = [];

//Reward
var Tokens = 0;
var XPMultiplier = 1.0;
var MonkeyMoney = 500;
var XP = 0;
var MonkeyMoneyMultiplier = 1;

//Special Coniditions
//Unknown
var RoundStep = 1.0;
var PauseBetweenRounds = true;
var SpeedModifier = 1.0;
var PriceModifier = 1.0;
var SellPriceModifier = 0.8;

//The Crucible
var WaterToCrucible = false;

//Mix N Match
var FreeTowersSecondRound = false;

//No Escape
var LoseLivesTimer = 1;
var LoseLivesAmount = 1;
var LoseLivesGracePeriod = 30; //in seconds

//Wizard Lord
var ConsumeMostExpensiveTowerRounds = 2;

//FastUpgrades
var TowersAutoUpgrade = false;

//Short Lived
var TowerLifespan = -1;

//Covert Pops
var BloonsForcedCamo = [];


//EXTRA FOR CODE
var map = "monkey_lane";
var mapnames = ["monkey_lane", "bloom", "present_delivery", "rabbit_holes", "snowy_backyard", "sprint_track", "express_shipping", "checkers", "skull_peak", "lobby", "3_times_around", "grotto", "patch", "hedge_maze", "fireworks", "brick_wall", "z_factor", "maze", "frozen_lake", "roswell", "space_truckin", "walk_in_the_park", "ancient_tomb", "hearthside", "six_feet", "river_rapids", "wattle_trees", "pyramids", "dune_sea", "lava_fields", "ice_flow", "country_road", "jungle", "workshop", "bloon_of_clubs", "archipelago", "crop_circles", "slalom", "stream", "dock_side", "villageshore", "trick_or_treat", "battle_knot","candyland","crypt_keeper", "long_range", "water_hazard", "rink_revenge", "challenger_deep", "scorched_earth", "u_turn","the_great_divide","the_eye","one_direction", "lightning_scar","go_with_the_flow","mount_magma","siege","double_double_crossover","tunnels","castle","against_the_clock","drag_strip","canyon","treetops","runway","down_the_drain","benguela","web","forestpath","tar_pit","main_street","radioactive"];
var towernames = ["DartMonkey", "TackTower", "SniperMonkey", "BoomerangThrower", "NinjaMonkey", "BombTower", "IceTower", "GlueGunner", "MonkeyBuccaneer", "MonkeyAce", "SuperMonkey", "MonkeyApprentice", "MonkeyVillage", "BananaFarm", "MortarTower", "DartlingGun", "SpikeFactory", "HeliPilot", "MonkeyEngineer", "Bloonchipper", "MonkeySub","AngrySquirrel","BananaFarmer","BeeKeeper","BloonberryBush","BloonsdayDevice","MeerkatSpy","Radadactyl","SuperMonkeyStorm","TribalTurtle"];
var LockedTowerNums = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
var NumLockedTowers = 0;
var LockedUpgradeIds = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
var NumUpgradeLocks = 0;
var labnames = ["AbilityCooldown","AttackSpeed","BigBloonSabotage","DoublePierce","SellAmount","StartingCash","StartingLives"];
var LabNums = [0,0,0,0,0,0,0];
var NumLabBlocks = 0;
var bloonsname = ["Red","Blue","Green","Yellow","Pink","Black", "White","Lead","Zebra","Rainbow","Ceramic","Golden","MOAB","BFB","ZOMG"];
var buildingnames = ["AcePrivateHangar", "AlsCustomChippers", "BombingRange", "BoomerangDojo", "DartlingAmmoDump", "DartTrainingFacility", "EngineersWorkshop", "GlueSupplyDepot", "HeloHangar", "IceFortress", "MageSpire", "MortarEmplacement", "NinjaAcademy", "PirateCove", "RifleRange", "SpikesRUs", "SubConstructionYard", "SuperMonkeyLair", "TackResearchCenter"];
var NumBuildBlocks = 0;
var BuildNums = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

//Towers is going to be a click to deactivate kind of deal

//Maps will be a switch case specifying which // no dont do that wtf go away

//Checkboxes for specailities
//UI
var modal = document.getElementById('modal');
var modal2 = document.getElementById('modal2');
var span = document.getElementsByClassName("close")[0];
var span2 = document.getElementsByClassName("close2")[0];
let challenge = {
	Setup:{
		Health:150,
		Money:650
	},
	Rules:{
		BlockedLabUpgrades:[],
		BlockedSpecialties:[],
		BloonLevelOffsets:[],
		CanSave:false,
		LockedTowers:[],
		LockedUpgrades:[],
		MaxNumberOfEachTower:-1,
		MaxNumberOfTotalTowers:-1,
		Reward:{
			MonkeyMoney:0,
			MonkeyMoneyMultiplier:1,
			XP:0,
			XPMutliplier:1

		},
		TargetRound:65	

	},
	nk_description:"",
	nk_mode:1,
	nk_rank_required:20,
	nk_title:"",
	nk_track:"",

}
document.getElementById('output').style.display = "none";

window.addEventListener('load',()=>{
	makeMaps();
	makeTowers();
	makeUpgrades();
	makeLabUpgrades();
});

let makeMaps = ()=>{
	let output = document.querySelector('.maps');
	mapnames.forEach(m=>{
		let newMap = document.createElement('img');
		newMap.className = 'mapIcon';
		newMap.src = `./Images/Tracks/${m}_thumb.jpg`
			newMap.addEventListener('click',function(){
				changemap(this);
			});
		output.appendChild(newMap);
	});	
}
let makeTowers = ()=>{
	let output = document.getElementById('towers');
	towernames.forEach(t=>{
		let newTower = document.createElement('img');
		newTower.className = 'towerIcon';
		newTower.src = `./Images/Towers/${t}.png`
			newTower.addEventListener('click',function(){
				locktower(this);
			});
		output.appendChild(newTower);
	});	
}
let makeUpgrades = ()=>{
	let output = document.getElementById('locks');
	towernames.forEach((u,i)=>{
		if(i > 20) return;
		let newContainer = document.createElement('div');
		newContainer.className = 'container';
		let newTower = document.createElement('img');
		newTower.className = 'towerIcon';
		newTower.src = `./Images/Towers/${u}.png`
			newTower.addEventListener('click',function(){
				locktower(this);
			});
		output.appendChild(newTower);
		let newText = document.createElement('div');
		newText.className = 'centered';
		newText.innerText = '4/4';
		newContainer.appendChild(newTower);
		newContainer.appendChild(newText);
		newContainer.addEventListener('click',function(){
			upgradelock(this);
		});
		output.appendChild(newContainer);
	});	
}
let makeLabUpgrades = ()=>{
	let output = document.getElementById('labUpgrades');
	labnames.forEach(l=>{
		let newLab = document.createElement('img');
		newLab.className = 'towerIcon';
		newLab.src = `./Images/Lab/${l}.png`
			newLab.addEventListener('click',function(){
				lablock(this);
			});
		output.appendChild(newLab);
	});	
}
function selectmap() {
	modal.style.display = "block";
}
function bloonranks() {
	modal2.style.display = "block";
}
span.onclick = function() {
	modal.style.display = "none";
}
span2.onclick = function() {
	modal2.style.display = "none";
}

function changegamemode(value){
	console.log(value);
	nk_mode = value;
}

function changemap(selected){
	let map = [...selected.parentNode.children].indexOf(selected);
	document.getElementById("changemapbtn").src = "\.\/Images\/Tracks\/" + mapnames[map] + "_thumb.jpg";
	nk_track = mapnames[map];
	console.log("New Map = " + mapnames[map]);
}

function locktower(selected){
	let towerid = [...selected.parentNode.children].indexOf(selected);
	if(LockedTowerNums[towerid] == 0){
		selected.style.filter = "grayscale(100%)";
		LockedTowerNums[towerid] = 1;
	} else if(LockedTowerNums[towerid] == 1){
		selected.style.filter = "grayscale(0%)";
		LockedTowerNums[towerid] = 0;
	}
	makearray();
}

function changebloon(newvalue, type){
	var test = bloonsname[type] + "2";
	var min = document.getElementById(bloonsname[type] + "Slider").min;
	document.getElementById(test).src = "./Images/Bloon/" + bloonsname[newvalue - min] + ".png";
	BloonLevelOffsets[type] = newvalue; 
}

function makearray(){
	LockedTowers = [];
	NumLockedTowers = 0;
	for(var i=0; i<towernames.length;i++){
		if(LockedTowerNums[i] == 1){
			LockedTowers[NumLockedTowers] = `"${towernames[i]}"`;
			NumLockedTowers++;
		}
	}
}

function lablock(selected){
	let labid = [...selected.parentNode.children].indexOf(selected);
	if(LabNums[labid] == 0){
		LabNums[labid] = 1;
		selected.style.filter = "grayscale(100%)";
	} else if(LabNums[labid] == 1){
		LabNums[labid] = 0;
		selected.style.filter = "grayscale(0%)";
	}
	makelabarray();
}
function buildingblock(labid){
	if(BuildNums[labid] == 0){
		BuildNums[labid] = 1;
		document.getElementById(buildingnames[labid]).style.filter = "grayscale(100%)";
	} else if(BuildNums[labid] == 1){
		BuildNums[labid] = 0;
		document.getElementById(buildingnames[labid]).style.filter = "grayscale(0%)";
	}
	makebuildingarray();
}

function makebuildingarray(){
	NumBuildBlocks = 0;
	BlockedSpecialties = [];
	for(var i = 0; i<buildingnames.length; i++){
		if(BuildNums[i] == 1){
			BlockedSpecialties[NumBuildBlocks] = "\"" + buildingnames[i] + "\"";
			NumBuildBlocks++;
		}
	}
	console.log(BlockedSpecialties);
}

function makelabarray(){
	NumLabBlocks = 0;
	BlockedLabUpgrades = [];
	for(var i = 0; i<labnames.length; i++){
		if(LabNums[i] == 1){
			BlockedLabUpgrades[NumLabBlocks] = "\"" + labnames[i] + "\"";
			NumLabBlocks++;
		}
	}
	console.log(BlockedLabUpgrades);
}

function upgradelock(selected){
	let towerid = [...selected.parentNode.children].indexOf(selected);
	var left = prompt("Please enter the amount of upgrades you can buy on the left side", "4");
	var right = prompt("Please enter the amount of upgrades you can buy on the right side", "4");
	if(!left){
		left = "4";
	}
	if(!right){
		right = "4";
	}
	selected.children[1].innerText = left + "/" + right;
	LockedUpgradeIds[towerid] = left + "/" + right;

}

function makearray2() {
	var numoflocks = 0;
	for(var i = 0; i<20; i++){
		if(LockedUpgradeIds[i] != 0){
			document.getElementById('output').innerHTML += "\n            {\n                \"Type\": \"" + towernames[i] + "\", \n                \"Upgrades\": [\n                    " + LockedUpgradeIds[i].substring(0,1) + ",\n                    " + LockedUpgradeIds[i].substring(2) + "\n                ]\n            },";
			numoflocks++;
		}
		if(i == 19 && numoflocks != 0){
			document.getElementById('output').innerHTML = document.getElementById('output').innerHTML.substring(0, document.getElementById('output').innerHTML.length - 1)
		}
	}
}

function updatedata(){
	nk_title = document.getElementById('name').value;
	nk_rank_required = document.getElementById('rank').value;
	nk_description = document.getElementById('description').value;
	var cash = document.getElementById('startcash').value;
	if(cash == "DEFAULT"){
		StartingCash = 650;
	} else {
		StartingCash = document.getElementById('startcash').value;
	}
	if(document.getElementById("startlives").value == "DEFAULT") {
		switch(nk_mode){
			case 0:
				StartingLives = 200;
				break;
			case 1:
				StartingLives = 150;
				break;
			case 2:
				StartingLives = 100;
				break;
			case 3: 
				StartingLives = 1;
				break;
			case 4:
				StartingLives = 100;
				break;
			case 5:
				StartingLives = 100;
				break;
		}
	} else {
		StartingLives = document.getElementById("startlives").value;
	}
	StartRound = document.getElementById('startround').value;
	var cb = document.getElementById('CanSave');
	if(cb.checked == true){
		CanSave = true;
	} else {
		CanSave = false;
	}
	console.log(document.getElementById("endround").value);
	console.log("hi");
	if(document.getElementById("endround").value == "DEFAULT"){
		nk_mode = Number(nk_mode);
		switch(nk_mode){
			case 0:
				TargetRound = 50;
				break;
			case 1:
				TargetRound = 65;
				break;
			case 2:
				console.log("hi");
				TargetRound = 85;
				break;
			case 3: 
				TargetRound = 85;
				break;
			case 4:
				TargetRound = -1;
				break;
			case 5:
				TargetRound = -1;
				break;
		}
	} else {
		TargetRound = document.getElementById("endround").value;
	}


	console.log(BloonLevelOffsets);

	MaxNumberOfTotalTowers = document.getElementById("maxmonkeys").value;
	MaxNumberOfEachTower = document.getElementById("maxeachmonkeys").value;

	//console.log(LockedUpgrades);

}

//what in the unholy fuck was this
function finished(){
	document.getElementById('output').style.display = "block";
	updatedata();
	var a = "";
	//print
	document.getElementById('output').innerHTML += "{\n    \"nk_description\": \"";
	document.getElementById('output').innerHTML += nk_description;
	document.getElementById('output').innerHTML += "\", \n    \"Rules\": {\n        \"BlockedSpecialties\": ["
		document.getElementById('output').innerHTML += BlockedSpecialties;
	document.getElementById('output').innerHTML += "], \n        \"TargetRound\": ";
	document.getElementById('output').innerHTML += TargetRound;
	document.getElementById('output').innerHTML += ", \n        \"CanSave\": ";
	document.getElementById('output').innerHTML += CanSave;
	document.getElementById('output').innerHTML += ", \n        \"LockedTowers\": [";
	document.getElementById('output').innerHTML += LockedTowers;
	document.getElementById('output').innerHTML += "], \n        \"LockedUpgrades\": [";
	makearray2();
	document.getElementById('output').innerHTML += "\n        ], \n        \"BlockedLabUpgrades\": [";
	document.getElementById('output').innerHTML += BlockedLabUpgrades;
	document.getElementById('output').innerHTML += "], \n        \"MaxNumberOfTotalTowers\": "
		document.getElementById('output').innerHTML += MaxNumberOfTotalTowers;
	document.getElementById('output').innerHTML += ", \n        \"MaxNumberOfEachTower\": ";
	document.getElementById('output').innerHTML += MaxNumberOfEachTower;
	document.getElementById('output').innerHTML += ", \n        \"BloonLevelOffsets\": [";
	document.getElementById('output').innerHTML += BloonLevelOffsets;
	document.getElementById('output').innerHTML += "], \n        \"Reward\": {\n            \"XPMultiplier\": 1,\n             \"MonkeyMoney\": 50,\n             \"XP\": 0,\n             \"MonkeyMoneyMultiplier\": 1\n        }\n    },  ";
	document.getElementById('output').innerHTML += "\n    \"Setup\": {\n        \"Money\": ";
	document.getElementById('output').innerHTML += StartingCash;
	document.getElementById('output').innerHTML += ", \n        \"Health\": ";
	document.getElementById('output').innerHTML += StartingLives;
	document.getElementById('output').innerHTML += ", \n        \"StartRound\": ";
	document.getElementById('output').innerHTML += StartRound;
	document.getElementById('output').innerHTML += "\n    }, \n";
	document.getElementById('output').innerHTML += "    \"nk_title\": \"";
	document.getElementById('output').innerHTML += nk_title;
	document.getElementById('output').innerHTML += "\", \n    \"nk_track\": \"";
	document.getElementById('output').innerHTML += nk_track;
	document.getElementById('output').innerHTML += "\", \n    \"nk_rank_required\": ";
	document.getElementById('output').innerHTML += nk_rank_required;
	document.getElementById('output').innerHTML += ", \n    \"nk_mode\": ";
	document.getElementById('output').innerHTML += nk_mode;
	document.getElementById('output').innerHTML += "\n}";


}

for(var i=0; i<towernames.length;i++){
	console.log("\<img id \=\"" + towernames[i] + "\" src=\"\.\/Images\/Towers\/" + towernames[i] + ".png\" style\=\"width\:62px\;height\:71px;\" onclick\=\"locktower\(" + i + "\)\"\>\<\/img\>");
}
						</script>
	</body>
	</head>
</html>
